## 🚙 인터넷 통신

클라이언트가 복잡한 인터넷 망을 거쳐서 어떻게 서버에 전송할까?

## 🚙 IP(Internet Protocol)

- IP 주소에 메세지를 전달할 수 있도록 정해둔 규칙
- 패킷에 담아서 데이터를 전송
  - IP 출발 주소, 목적 주소, 전송 데이터 ...
  - 노드들을 거쳐서 목적 주소에 도착
  - 클라이언트 패킷 전달(요청) 경로와 서버 패킷 전달(응답) 경로는 다를 수 있음
  - 여러 어플리케이션이 한 IP를 쓰고 있다면?

### 대상이 서비스 불능, 패킷 전송

- 클라이언트는 대상 서버가 패킷을 받을 수 있는 상태인지 모르는 상태로 패킷을 보내는 한계점

### 패킷 소실

- 전송 중 패킷이 소실되도 소실 여부를 알지 못함

### 패킷 전달 순서 문제 발생

- 하나의 데이터를 여러 패킷으로 분할해서 보낼 때 순서가 보장되지 않는 문제 발생
- 여러 패킷이 각각 다른 경로로 전송될 수 있기 때문

## 🚙 TCP, UDP

### 인터넷 프로토콜 스택의 4계층

- 애플리케이션 계층 : HTTP, FTP
- 전송 계층 : TCP, UDP
- 인터넷 계층 : IP
- 네트워크 인터페이스 계층

### 프로토콜 계층

1. 프로그램이 메시지 생성 (애플리케이션 계층 - 웹 브라우저, 네트워크 게임, 채팅 프로그램 ...)
   - 생성 후 SOCKET 라이브러리가 메시지를 OS계층에 넘김
2. OS 계층에서는 메시지를 TCP 정보로 감싼 후 IP 정보로 감쌈(IP 패킷 생성)
3. 네트워크 인터페이스(LAN 드라이버, LAN 장비)는 Ethernet frame에 IP 패킷을 넣어서 전송

### TCP/IP 패킷 정보

- TCP/IP 패킷에는 IP 패킷 안에 **TCP 세그먼트**가 들어감
  - 출발지 PORT, 목적지 PORT, 전송 제어 ,순서, 검증 정보 ...
- IP의 여러 문제들을 해결

### TCP 특징

- 전송 제어 프로토콜

1. 연결지향 : 연결이 되는지 먼저 확인 후 전송
2. 데이터 전달 보증 : 누락이 되었을 때 알려줌
3. 순서 보장

### TCP 3 way handshake

- 연결이 됨을 확인하는 과정
- 연결이 정상적으로 되는지 확인하고 데이터를 전송함
- 최근에는 최적화로 3번 단계에서 데이터를 전송
- 개념적 연결

1. SYN : 클라이언트에서 서버로 SYN 메세지 보냄
2. SYN+ACK : 서버가 SYN를 받고 응답(ACK)과 연결을 요청하는 SYN 함께 보냄
3. ACK : 클라이언트가 응답을 보냄
4. 데이터 전송

### 데이터 전달 보증

- 데이터 전송 후 서버에서 데이터를 받았음을 응답

### 순서 보장

- 서버에 순서대로 도착하지 않았다면 서버에서 클라이언트에게 패킷을 다시 요청
- 순서가 잘못된 패킷부터 전송 요청

### UDP 특징

- 사용자 데이터그램 프로토콜(User Datagram Protocol)
- 데이터 전달 순서가 보장되지 않지만 단순하고 빠름
- IP와 비슷하지만 포트 정보와 체크섬 데이터를 포함
- TCP는 변경이 어렵기 때문에 UDP를 어플리케이션으로 확장하여 사용

## 🚙 PORT

- 같은 IP 내에서 프로세스 구분
- 하나의 클라이언트가 여러 서버와 통신해야 한다면?
  - IP만 가지고 통신했을 때 어떤 어플리케이션의 응답 패킷인지 알 수 없음
- PORT를 추가하여 어플리케이션 구분
- 0 ~ 65535 할당
  - 0 ~ 1023 : 잘 알려진 포트, 사용 지양

## 🚙 DNS(Doamin Name System)

- IP는 기억하기 어렵고, 변경될 수 있음
- DNS 서버에 도메인 명을 등록해서 사용
  1. 클라이언트가 DNS 서버에 도메인 명으로 요청을 보냄
  2. DNS 서버가 IP 주소 응답
  3. 클라이언트는 응답받은 IP 주소로 접속
- IP 주소가 변경되면 DNS 서버에 저장된 주소만 변경
